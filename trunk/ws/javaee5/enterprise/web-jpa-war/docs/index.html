<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=windows-1252">
	<TITLE>The Java Persistence Sample Application</TITLE>
	<META NAME="GENERATOR" CONTENT="StarOffice 8  (Win32)">
	<META NAME="CREATED" CONTENT="20060817;13180171">
	<META NAME="CHANGEDBY" CONTENT="Mitesh">
	<META NAME="CHANGED" CONTENT="20060817;14061242">
	<STYLE>
	<!--
		TD P { color: #000000; font-family: "geneva", "helvetica", "arial", "lucida sans", sans-serif; font-size: 10pt }
		H1 { color: #000000; font-family: "geneva", "helvetica", "arial", "lucida sans", sans-serif; font-size: 18pt }
		P { color: #000000; font-family: "geneva", "helvetica", "arial", "lucida sans", sans-serif; font-size: 10pt }
		H2 { color: #000000; font-family: "geneva", "helvetica", "arial", "lucida sans", sans-serif; font-size: 14pt }
		H3 { color: #000000; font-family: "geneva", "helvetica", "arial", "lucida sans", sans-serif; font-size: 12pt }
		P.copy { font-family: "geneva", "helvetica", "arial", "lucida sans", sans-serif; font-size: 8pt; text-align: center }
		A:link { color: #594fbf; font-family: "geneva", "helvetica", "arial", "lucida sans", sans-serif; font-size: 10pt }
		CODE { color: #666666; font-family: "monaco", "courier", "courier new"; font-size: 10pt }
		A:visited { color: #1005fb; font-family: "geneva", "helvetica", "arial", "lucida sans", sans-serif; font-size: 10pt }
	-->
	</STYLE>
</HEAD>
<BODY LANG="en-US" TEXT="#000000" LINK="#594fbf" VLINK="#1005fb" BGCOLOR="#ffffff" DIR="LTR">
<TABLE WIDTH=100% BORDER=0 CELLPADDING=2 CELLSPACING=4 STYLE="page-break-before: always">
	<TR>
		<TD VALIGN=TOP BGCOLOR="#587993">
			<P ALIGN=RIGHT><B><FONT SIZE=2><FONT COLOR="#ffffff">Sun Java
			System Application Server</FONT></FONT></B>&nbsp; 
			</P>
		</TD>
	</TR>
</TABLE>
<P><!---- Don't modify anything above this line, except for the title tag --------><A HREF="../../../docs/list.html">Samples
Index</A></P>
<H1>The Java Persistence / Servlet Sample Application</H1>
<P>This sample demonstrates the use of Java Persistence APIs based on
the new Java Persistence specification within a servlet.</P>
<P>If you are familiar with EJB 2.1 persistence, you will notice many changes in this example based on the new Java Persistence
specification: 
</P>
<UL>
	<LI><P STYLE="margin-bottom: 0in">There are no complex and arcane
	deployment descriptors. All metadata information is specified by
	annotations.</P>
	<LI><P STYLE="margin-bottom: 0in">You can rely a great deal on
	defaults, so you code for the exceptional cases. This significantly
	reduces turnaround time for implementations. 
	</P>
	<LI><P>Most importantly, you can switch your persistence
	implementation to any vendor that supports the Java Persistence
	specification. 
	</P>
</UL>
<H2>Application Structure</H2>
<P>The application is built and deployed as a WAR file. 
</P>
<H3>Web Module</H3>
<P>The web module consists of: 
</P>
<UL>
	<LI><P STYLE="margin-bottom: 0in">A POJO which represents a Person.
	The persistence.xml file defines a persistence unit. The
	persistence unit uses jdbc/__default as the data source, and the
	java2db feature of glassfish to create tables.</P>
	<LI><P STYLE="margin-bottom: 0in">A servlet that corresponds to
	listing current Person records in the database, and another that
	corresponds to creating a Person record in the database. Also, two
	JSP pages render the view.</P>
	<P STYLE="margin-bottom: 0in"></P>
</UL>
<P>The starting point of the application is defined as index.jsp
which forwards to the ListPerson servlet. The servlet queries the list of
Person records from the database using Java Persistence API. The list
is passed on to ListPerson.jsp to render. You can click the Create
a Person Record link at bottom of the listing to go to
CreatePerson.jsp. This renders a form where you can enter data for a
new Person record. When you click the CreateRecord button,
the form is submitted to CreatePerson Servlet which creates a new
Person record in the database using Java Persistence API.     
</P>
<P>Please note the pattern used to obtain an EntityManager instance in
the servlets.  It is always obtained from injected
EntityManagerFactory. Here is a <A HREF="https://blueprints.dev.java.net/bpcatalog/ee5/persistence/webonlyapp.html">discussion</A>
about why this pattern is used instead of directly injecting an
EntityManager.</P>
<H2>Application Archive</H2>
<P>The web-module is archived in web-jp-war.war.</P>
<H2>Building, Deploying, and Running the Application</H2>
<P>Follow these steps to build, deploy, and run the application.</P>
<OL>
	<LI><P STYLE="margin-bottom: 0in">Set up your build environment and
	Configure the application server with which the build system has to
	work by following the <A HREF="../../../docs/UserREADME.html">common
	build instructions.</A> 
	</P>
	<LI><P>Make sure the JavaDB database is started. If not, refer to
	<A HREF="../../../docs/UserREADME.html">common build instructions.</A>
		</P>
	<LI><P STYLE="margin-bottom: 0in">Use the target <CODE>all</CODE>
	to build, deploy and run the project. 
	</P>
	<LI><P>Use the target <CODE>clean</CODE> to remove the temporary
	directories like build and dist 
	</P>
</OL>

<h2>Building, Deploying, and Running the Application in NetBeans IDE</h2>
<p>
Follow these instructions to build, deploy, and run
this sample application using NetBeans IDE.
</p>
<ol>
  <li> Refer to  <a href="../../../docs/UserREADME.html"> common build instructions.</a>
       for setting up NetBeans IDE and the application server with which the IDE will use.</li>
  <li> In NetBeans IDE, select File->OpenProject and select 
<code><i>samples_install_dir</i>/javaee5/enterprise/web-jpa-war</code> as the project.</li>
  <li> Right click on <code>web-jpa-war</code> and select <code>Run Project</code> which will build, deploy and run the project. If configured properly, the IDE will open the browser with appropriate url. Sample output is given below. </li>
  <b>NetBeans IDE output</b>
  <pre>
  All operations completed successfully
  run-deploy:
  Browsing: http://localhost:8080/web-jpa-war/
  run-display-browser:
  run:
  BUILD SUCCESSFUL (total time: 2 seconds)
  </pre>
  <b>Browser output</b>
  <pre>
  http://localhost:8080/web-jpa-war/

  List of Persons currently in Database
  ID    FirstName   LastName

  Create a Person Record
  </pre>
</ol>

<H2>Troubleshooting</H2>
<P>If you have problems when running the application, refer to
<A HREF="../../../docs/UserTroubleShooting.html">troubleshooting
document</A>. 
</P>
<P STYLE="margin-bottom: 0in">&nbsp;<!--- Do not modify the rest of the document -->
</P>
<HR SIZE=1 NOSHADE>
<P CLASS="copy"><!-- start copyright -->Copyright &copy; 2006 <A HREF="http://sun.com/">Sun
Microsystems, Inc.</A> All rights reserved. 
</P>
<P><!-- end copyright --><BR><BR>
</P>
</BODY>
</HTML>
