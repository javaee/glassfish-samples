<?xml version="1.0" encoding="UTF-8"?>
<!-- Copyright 1997-2007 Sun Microsystems, Inc. All rights reserved.-->

<project name="hello-singleton-ejb" default="all" basedir=".">

    <property name="is.ejb-jar.module" value="true"/>

    <property file="${user.home}/build.properties"/>
    <property name="javadoc.packagenames" value="enterprise.hello_singleton_ejb"/>
    <property name="classesdir" value="./build"/>

    <import file="../../../bp-project/main.xml"/>
     <path id="classpath">

        <fileset dir="${javaee.home}/modules">
                      <include name="*.jar"/>
               
                   </fileset>

        <pathelement location="${classesdir}"/>

    </path>

     <target name="init">
        <condition property="windows">
            <os family="windows" />
        </condition>
        <condition property="unix">
            <os family="unix" />
        </condition>
         <mkdir  dir="${classesdir}"/>
    </target>

    <target name="all" depends="init,default,deploy">
      
        <antcall target="run"/>
    </target>

    <target name="-pre-clean" depends="undeploy">
        <subant target="clean">
            <fileset dir="hello-singleton-client" includes="build.xml"/>
        </subant>
    </target>



    <target name="get-artifacts" depends="deploy,get-artifacts-windows,get-artifacts-unix"/>

    <target name="get-artifacts-windows" if="windows">
        <exec executable="${javaee.home}/bin/wsimport.bat">
            <arg line="-keep -Xendorsed -d ${classesdir} -p enterprise.hello_singleton_ejb http://${javaee.server.name}:${javaee.server.port}/HelloSingletonImplService/HelloSingletonImpl?WSDL"/>
        </exec>
    </target>

    <target name="get-artifacts-unix" if="unix">
        <exec executable="${javaee.home}/bin/wsimport">
            <arg line="-keep -Xendorsed -d ${classesdir} -p enterprise.hello_singleton_ejb http://${javaee.server.name}:${javaee.server.port}/HelloSingletonImplService/HelloSingletonImpl?WSDL"/>
        </exec>
    </target>

    <target name="compile-client" depends="init,get-artifacts">
        <javac srcdir="hello-singleton-client/src/java" destdir="${classesdir}">
            <classpath refid="classpath"/>
        </javac>
    </target>


 <target name="run" depends="compile-client,run-client-windows,run-client-unix"/>

    <target name="run-client-windows" if="windows">
        <exec executable="${javaee.home}/bin/appclient.bat" dir="${classesdir}">
            <arg value="enterprise.hello_singleton_client.SingletonJavaClient"/>
        </exec>
    </target>

    <target name="run-client-unix" if="unix">
        <exec executable="${javaee.home}/bin/appclient" dir="${classesdir}" failifexecutionfails="false">
            <arg value="enterprise.hello_singleton_client.SingletonJavaClient"/>    
        </exec>
    </target>


   

</project>
